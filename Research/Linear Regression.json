{"paragraphs":[{"text":"%pyspark\n\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\nfrom pyspark.sql import SparkSession","user":"anonymous","dateUpdated":"2019-06-17T18:11:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560794828357_824543674","id":"20190617-180708_805080349","dateCreated":"2019-06-17T18:07:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1167","dateFinished":"2019-06-17T18:19:28+0000","dateStarted":"2019-06-17T18:11:20+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import VectorAssembler, StringIndexer, VectorIndexer\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder, TrainValidationSplit\n\nfrom pyspark.ml.regression import LinearRegression\nfrom pyspark.ml.evaluation import RegressionEvaluator\n\nfrom pyspark.sql import SQLContext\nsqlContext = SQLContext(sc)\nimport sys","user":"anonymous","dateUpdated":"2019-06-17T18:21:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560795666416_-50129293","id":"20190617-182106_743368908","dateCreated":"2019-06-17T18:21:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1305","dateFinished":"2019-06-17T18:21:11+0000","dateStarted":"2019-06-17T18:21:11+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\nratings_all = spark.read.csv('s3://monikamishrabucket/review_us.tsv',inferSchema=True, header=True,sep=\"\\t\")\n\nratings_all.createOrReplaceTempView(\"table1\") \n\ntsv = spark.sql(\"SELECT * FROM table1\")\n\ntsv1 = tsv.select(\"product_id\", \"product_parent\", \"product_title\", \"product_category\", \"helpful_votes\", \"total_votes\", \"vine\", \"verified_purchase\", \"review_headline\", \"review_body\", \"review_date\",\"star_rating\" )\n\n","user":"anonymous","dateUpdated":"2019-06-17T18:21:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821856_610391693","id":"20190616-224955_801932534","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:169","dateFinished":"2019-06-17T18:23:09+0000","dateStarted":"2019-06-17T18:21:17+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=0","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\ndf1 = tsv1.filter(tsv1.product_category.isNotNull())\ndf2 = df1.filter(df1.helpful_votes.isNotNull())\ndf3 = df2.filter(df2.total_votes.isNotNull())\ndf4 = df3.filter(df3.vine.isNotNull())\ndf5 = df4.filter(df4.verified_purchase.isNotNull())\ndf6 = df5.filter(df5.review_headline.isNotNull())\ndf7 = df6.filter(df6.review_body.isNotNull())\ndf8 = df7.filter(df7.review_date.isNotNull())\ndf9 = df8.filter(df8.star_rating.isNotNull())\n\ndata = df9.select(\"product_id\", \"product_parent\", \"product_title\", \"product_category\", \"helpful_votes\", \"total_votes\", \"vine\", \"verified_purchase\",col(\"star_rating\").alias(\"label\"))\n","user":"anonymous","dateUpdated":"2019-06-17T18:23:14+0000","config":{"colWidth":12,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821857_810618313","id":"20190616-225033_620055753","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:170","dateFinished":"2019-06-17T18:23:14+0000","dateStarted":"2019-06-17T18:23:14+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\ndata = StringIndexer(inputCol='product_id', outputCol='product_id'+\"_index\").fit(data).transform(data)\ndata = StringIndexer(inputCol='product_title', outputCol='product_title'+\"_index\").fit(data).transform(data)\ndata = StringIndexer(inputCol='product_category', outputCol='product_category'+\"_index\").fit(data).transform(data)\ndata = StringIndexer(inputCol='vine', outputCol='vine'+\"_index\").fit(data).transform(data)\ndata = StringIndexer(inputCol='verified_purchase', outputCol='verified_purchase'+\"_index\").fit(data).transform(data)\n\n","user":"anonymous","dateUpdated":"2019-06-17T18:23:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821858_421467820","id":"20190616-225054_543542983","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:171","dateFinished":"2019-06-17T18:26:35+0000","dateStarted":"2019-06-17T18:23:18+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=2","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=3","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=4","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=5","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\n# Split the data\nsplits = data.randomSplit([0.7, 0.3])\n\n\nlr_train = splits[0]\nlr_test = splits[1].withColumnRenamed(\"label\", \"trueLabel\")\n\nprint (\"Training Rows:\", lr_train.count(), \" Testing Rows:\", lr_test.count())\n","user":"anonymous","dateUpdated":"2019-06-17T18:27:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821859_808180833","id":"20190616-225154_94512759","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:172","dateFinished":"2019-06-17T18:28:49+0000","dateStarted":"2019-06-17T18:27:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('Training Rows:', 4851372, ' Testing Rows:', 2079097)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=7","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\nassembler = VectorAssembler(inputCols = [\"product_parent\", \"helpful_votes\", \"total_votes\", \"product_id_index\", \"product_title_index\", \"product_category_index\", \"vine_index\", \"verified_purchase_index\"], outputCol=\"features\")","user":"anonymous","dateUpdated":"2019-06-17T18:29:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821859_514774391","id":"20190616-225247_811195240","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173","dateFinished":"2019-06-17T18:29:14+0000","dateStarted":"2019-06-17T18:29:14+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\nlr = LinearRegression(labelCol=\"label\",featuresCol=\"features\")\nlr_pipeline = Pipeline(stages=[assembler, lr])\n","user":"anonymous","dateUpdated":"2019-06-17T18:29:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821860_-1539388221","id":"20190616-224641_1388003167","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174","dateFinished":"2019-06-17T18:29:18+0000","dateStarted":"2019-06-17T18:29:18+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\nparamGrid = ParamGridBuilder().addGrid(lr.regParam, [0.3, 0.01]).addGrid(lr.maxIter, [10, 5]).build()\ncv = CrossValidator(estimator=lr_pipeline, evaluator=RegressionEvaluator(), estimatorParamMaps=paramGrid, numFolds=5)\n","user":"anonymous","dateUpdated":"2019-06-17T18:29:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821860_1421417599","id":"20190616-224612_614156143","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:175","dateFinished":"2019-06-17T18:29:24+0000","dateStarted":"2019-06-17T18:29:24+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\nlr_model = cv.fit(lr_train)\n","user":"anonymous","dateUpdated":"2019-06-17T18:29:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1560793821861_-2012255621","id":"20190616-222520_1844834092","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:176","dateFinished":"2019-06-17T18:55:00+0000","dateStarted":"2019-06-17T18:29:27+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=9","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=10","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=11","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=12","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=13","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=14","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=15","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=16","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=17","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=18","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=19","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=20","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=21","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=22","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=23","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=24","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=25","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=26","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=27","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=28","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=29","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=30","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=31","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=32","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=33","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=34","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=35","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=36","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=37","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=38","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=39","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=40","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=41","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=42","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=43","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=44","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=45","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=46","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=47","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=48","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=49","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=50","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=51","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=52","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=53","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=54","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=55","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=56","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=57","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=58","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=59","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=60","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=61","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=62","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=63","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=64","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=65","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=66","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=67","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=68","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=69","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=70","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=71","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=72","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=73","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=74","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=75","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=76","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=77","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=78","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=79","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=80","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=81","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=82","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=83","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=84","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=85","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=86","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=87","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=88","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=89","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=90","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=91","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=92","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=93","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=94","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=95","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=96","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=97","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=98","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=99","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=100","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=101","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=102","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=103","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=104","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=105","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=106","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=107","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=108","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=109","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=110","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=111","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=112","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=113","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=114","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=115","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=116","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=117","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=118","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=119","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=120","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=121","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=122","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=123","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=124","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=125","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=126","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=127","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=128","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=129","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=130","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=131","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=132","http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=133"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\nlr_prediction = lr_model.transform(lr_test)\nlr_predicted = lr_prediction.select(\"features\", \"prediction\", \"trueLabel\")\nlr_predicted.show(10)","user":"anonymous","dateUpdated":"2019-06-17T18:55:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+---------+\n|            features|        prediction|trueLabel|\n+--------------------+------------------+---------+\n|[2.75786765E8,3.0...|4.2272380066227155|        5|\n|[2.75786765E8,11....| 4.241601625128896|        5|\n|[2.75786765E8,45....| 2.847397137820707|        1|\n|[2.75786765E8,308...| 4.323221693424838|        5|\n|[3.07844923E8,5.0...| 4.104189015781167|        4|\n|[5.17434245E8,63....| 4.350245213077674|        5|\n|[2.75786765E8,13....| 4.238378526527413|        5|\n|[2.41676942E8,0.0...| 4.177053533360473|        5|\n|[4.98635851E8,0.0...| 4.193418536383112|        5|\n|[5.94264062E8,0.0...| 4.166363710020368|        4|\n+--------------------+------------------+---------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1560793821862_1794062566","id":"20190616-222712_1778416023","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:177","dateFinished":"2019-06-17T18:55:26+0000","dateStarted":"2019-06-17T18:55:19+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=135"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\nlr_evaluator = RegressionEvaluator(labelCol=\"trueLabel\", predictionCol=\"prediction\", metricName=\"rmse\")\nlr_rmse = lr_evaluator.evaluate(lr_prediction)\nprint (\"Root Mean Square Error (RMSE):\", lr_rmse)","user":"anonymous","dateUpdated":"2019-06-17T18:55:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560793821862_-1249625510","id":"20190616-223152_1636117903","dateCreated":"2019-06-17T17:50:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:178","dateFinished":"2019-06-17T18:58:48+0000","dateStarted":"2019-06-17T18:55:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('Root Mean Square Error (RMSE):', 1.1157071527745301)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-68.us-west-1.compute.internal:4040/jobs/job?id=136"],"interpreterSettingId":"spark"}}}],"name":"Linear Regression","id":"2EDDATM7P","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}